---
title: "Titanic_Disaster_Survivers"
author: "Pranjal Vijay"
date: "January 15, 2018"
output:
  pdf_document: default
  html_document: default
---
#Loading the Packages
```{r}
library(ggplot2)
library(dplyr)
```

#Loading the Data
```{r}
Traindataset<-read.csv("C:/Users/ddddd/Comptitions/Kaggle/Titanic_survived/train.csv", stringsAsFactors = F)
Testdataset<-read.csv("C:/Users/ddddd/Comptitions/Kaggle/Titanic_survived/test.csv", stringsAsFactors = F)
```


#Research Question: 
According to the provided data of Titanic Disaster we are asked to 0find out the information of people who survived . 
Observing the given data sets , I found these variables more impactable:
Survived , Sex and Age
I am going to calculate here that who survived more :
(i)  Males or Females 
(ii) People below or above average age 

#Starting of Solution
```{r}
summary(Traindataset)

```

```{r}
summary(Testdataset)

```

```{r}
Traindataset %>% 
  select(Age
, Sex
) %>% 
  str()
```

```{r}
Testdataset %>% 
  select(Age
, Sex
) %>% 
  str()
```


#Combining the data sets
```{r}
Testdataset$Survived <- NA
united_data <- rbind(Traindataset, Testdataset)
str(united_data)
```


#Showing the Missing Values
```{r}
sapply(Traindataset, function(x) {sum(is.na(x))})

```


#EDA of NA's
```{r}
NA_value <- as.data.frame(sort(sapply(united_data, function(x) sum(is.na(x))),decreasing  = F))
   
colnames(NA_value)[1] <- "missingvaluesPercentage"

NA_value$Survived <- rownames(NA_value)

ggplot(NA_value[NA_value$missingvaluesPercentage>0,],aes(reorder(Survived,-missingvaluesPercentage),missingvaluesPercentage,fill= Survived)) +geom_bar(stat="identity") +theme_minimal(base_family = "Ubuntu Condensed") +theme(axis.text.x =element_text(angle = 360, hjust = 0.5), legend.position = "left") + ylab("Na values") +xlab("Variables having NA") + ggtitle("Na(missing) values")

```

#Removing NA values
```{r}
Traindataset %>% 
  filter(Age != "NA") %>%
  group_by(Age) %>% 
  summarise(count = n())
```
```{r}
Traindataset %>% 
  filter(Sex != "NA") %>%
  group_by(Sex) %>% 
  summarise(count = n())
```

```{r}
Traindataset %>% 
  filter(Survived != "NA") %>%
  group_by(Survived) %>% 
  summarise(count = n())
```

#Looking for the conclusion

```{r}
Traindataset %>% 
filter(Survived != "NA", Sex != "NA") %>%
  group_by(Survived, Sex) %>% 
  summarise(count=n())
```
```{r }
library(statsr)
m_bty_gen <- lm(Survived ~ Sex, data = Traindataset)
summary(m_bty_gen)
plot(m_bty_gen)
```


Conclusion 1: Females survived less than males.


#Now move on to the next variable 'Age'
```{r}
united_data %>% 
filter(Survived != "NA", Age != "NA", Sex != "NA") %>%
  group_by(Survived, Age, Sex) %>% 
  summarise(count=n())

```


```{r}
united_data %>% 
  filter(!(is.na(Survived))) %>%
  summarise(Survivedmean = mean(Survived), Survivedmedian = median(Survived), Survivedsd = sd(Survived), Survivedmin = min(Survived), Survivedmax = max(Survived))
```


It can be seen that Average Survived is 0.38  Minimum Survived is 0 and Maximum age is 1

```{r}
united_data <- united_data %>% 
    filter(!(is.na(Survived))) %>%
  mutate(Survived = ifelse(Survived > 0, "Positive_Sur", "Negative_Sur"))
united_data %>% 
  group_by(Survived) %>% 
  summarise(count = n())
```



```{r}
united_data %>% 
  filter(!(is.na(Age))) %>%
  summarise(Agemean = mean(Age), Agemedian = median(Age), Agesd = sd(Age), 
            Agemin = min(Age), Agemax = max(Age))
```
It can be seen that Average age is 29 Minimum age is 14 and Maximum age is 80. 

```{r}
united_data <- united_data %>% 
    filter(!(is.na(Age))) %>%
   mutate(Age = ifelse(Age >= 28, "HighAge", "LowAge"))
united_data %>% 
  group_by(Age) %>% 
  summarise(count = n())
```

```{r}
united_data %>% 
  filter(!(is.na(Age)), !(is.na(Survived)), !(is.na(Sex))) %>%
  group_by(Age,Survived, Sex) %>% 
  summarise(count = n()) 
```



```{r}
ggplot(data = united_data, aes(x = Age, y = Survived), colours(Sex = 'Male')) +
  geom_line() +
  geom_point()
```
Coclusion:- 

It can be seen that No. of people have age more than 28 are More survived than no. of people have age equals to or less than 28.


